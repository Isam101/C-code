#include <stdio.h>
#include <stdbool.h>

// Prototypes allows the user to define the function ahead of calling it and allows the compiler to anticpate 
void CheckBalance(float balance);
float Deposit(void);
float Withdraw(float balance);

// Helper to flush bad input
void flush_line(void) {
    int c;
    while ((c = getchar()) != '\n' && c != EOF) {}
}

int main(void) {
    int choice = 0;
    float balance = 0.00f;

    printf(" Welcome to Isam Bank \n");

    do {
        printf("\nPlease Select One Of The Following Options:\n");
        printf(" 1. Check Balance\n 2. Deposit\n 3. Withdraw\n 4. Exit\n");
        printf("Enter your choice: ");

        if (scanf("%d", &choice) != 1) {
            printf("Invalid input. Please enter a number 1-4.\n");
            flush_line();
            continue;  // re-show the menu
        }

        switch (choice) {
            case 1:
                CheckBalance(balance);
                break;

            case 2: {
                float add = Deposit();
                balance += add;
                break;
            }

            case 3: {
                float sub = Withdraw(balance);
                balance -= sub;
                break;
            }

            case 4:
                printf("Thank you for using Isam Bank\n");
                break;

            default:
                printf("Invalid entry. Please choose 1-4.\n");
                break;
        }

    } while (choice != 4);

    return 0;
}

void CheckBalance(float balance) {
    printf("\nYour current balance is $%.2f\n", balance);
}

float Deposit(void) {
    float amount = 0.0f;
    printf("Please enter the amount you are depositing: $");

    if (scanf("%f", &amount) != 1) {
        printf("Invalid amount.\n");
        flush_line();
        return 0.0f;
    }

    if (amount <= 0.0f) {
        printf("Please enter an amount greater than $0.\n");
        return 0.0f;
    }

    printf("You have successfully deposited $%.2f\n", amount);
    return amount;
}

float Withdraw(float balance) {
    float amount = 0.0f;
    printf("Please enter the amount you want to withdraw: $");

    if (scanf("%f", &amount) != 1) {
        printf("Invalid amount.\n");
        flush_line();
        return 0.0f;
    }

    if (amount <= 0.0f) {
        printf("Please enter an amount greater than $0.\n");
        return 0.0f;
    }

    if (amount > balance) {
        printf("Insufficient funds. You have $%.2f available.\n", balance);
        return 0.0f;
    }

    printf("You have successfully withdrawn $%.2f\n", amount);
    return amount;
}
